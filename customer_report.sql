--Customers Report Summary


--Last Updated: February 2025

--Whole Foods Market
--Medium
--ID 2040

create database  report;
use report;

create table wfm_transactions(
 customer_id  bigint,
 store_id bigint,
 transaction_date datetime,
 transaction_id bigint,
 product_id bigint,
 sales bigint

);
  

-- Insert data into the transactions table
INSERT INTO wfm_transactions (customer_id, store_id, transaction_date, transaction_id, product_id, sales) VALUES
(1, 1, '2017-01-06 00:00:00', 1, 101, 13),
(1, 1, '2017-01-06 00:00:00', 1, 102, 5),
(1, 1, '2017-01-06 00:00:00', 1, 103, 1),
(2, 4, '2017-05-06 00:00:00', 2, 105, 20),
(5, 4, '2017-05-06 00:00:00', 5, 104, 12),
(6, 6, '2016-02-03 00:00:00', 6, 106, 3),
(7, 6, '2018-09-09 00:00:00', 7, 108, 5),
(8, 10, '2017-06-11 00:00:00', 8, 107, 2),
(8, 10, '2017-06-11 00:00:00', 8, 109, 9),
(8, 10, '2017-06-11 00:00:00', 8, 110, 10),
(11, 11, '2017-12-01 00:00:00', 11, 501, 16),
(12, 12, '2017-12-01 00:00:00', 12, 502, 15),
(13, 13, '2017-05-05 00:00:00', 13, 503, 13),
(14, 14, '2017-08-10 00:00:00', 14, 505, 15),
(14, 14, '2017-08-10 00:00:00', 14, 506, 5),
(14, 14, '2017-08-10 00:00:00', 14, 507, 500),
(14, 14, '2017-08-10 00:00:00', 14, 509, 300),
(18, 18, '2020-01-01 00:00:00', 18, 510, 30),
(19, 19, '2017-01-07 00:00:00', 19, 504, 50),
(19, 20, '2017-02-07 00:00:00', 20, 508, 22),
(1, 1, '2017-01-01 00:00:00', 21, 401, 10),
(2, 2, '2017-02-02 00:00:00', 22, 402, 16),
(3, 3, '2017-03-06 00:00:00', 23, 403, 15),
(4, 4, '2017-04-07 00:00:00', 24, 404, 13),
(5, 5, '2017-05-09 00:00:00', 25, 405, 15),
(6, 6, '2017-06-10 00:00:00', 26, 406, 5),
(7, 7, '2017-07-12 00:00:00', 27, 407, 500),
(8, 8, '2017-08-13 00:00:00', 28, 408, 300),
(9, 9, '2017-09-14 00:00:00', 29, 409, 9),
(10, 10, '2017-10-16 00:00:00', 30, 410, 10),
(11, 10, '2017-11-17 00:00:00', 31, 301, 16),
(12, 11, '2017-12-19 00:00:00', 32, 302, 15),
(13, 12, '2017-01-01 00:00:00', 33, 303, 13),
(14, 13, '2017-02-02 00:00:00', 34, 304, 15),
(15, 14, '2017-03-06 00:00:00', 35, 305, 5),
(16, 15, '2017-04-07 00:00:00', 36, 306, 500),
(17, 16, '2017-05-09 00:00:00', 37, 307, 300),
(18, 15, '2017-06-10 00:00:00', 38, 308, 30),
(19, 16, '2017-07-12 00:00:00', 39, 309, 50),
(20, 17, '2017-08-13 00:00:00', 40, 310, 22),
(1, 18, '2017-09-14 00:00:00', 41, 201, 100),
(2, 2, '2017-10-16 00:00:00', 42, 202, 36),
(3, 3, '2017-11-17 00:00:00', 43, 203, 78),
(4, 4, '2017-12-19 00:00:00', 44, 204, 99),
(5, 5, '2017-01-01 00:00:00', 45, 205, 26),
(6, 6, '2017-02-02 00:00:00', 46, 206, 265),
(7, 7, '2017-03-06 00:00:00', 47, 207, 215),
(8, 8, '2017-04-07 00:00:00', 48, 208, 98),
(9, 9, '2017-05-09 00:00:00', 49, 209, 66),
(10, 10, '2017-06-10 00:00:00', 50, 210, 34),
(11, 10, '2017-07-12 00:00:00', 51, 601, 31),
(12, 11, '2017-08-13 00:00:00', 52, 602, 89),
(13, 12, '2017-09-14 00:00:00', 53, 603, 59),
(14, 13, '2017-10-16 00:00:00', 54, 604, 70),
(15, 14, '2017-11-17 00:00:00', 55, 605, 9),
(16, 15, '2017-12-19 00:00:00', 56, 606, 13),
(17, 16, '2017-10-16 00:00:00', 57, 607, 5),
(18, 15, '2017-11-17 00:00:00', 58, 608, 1),
(19, 16, '2017-12-19 00:00:00', 59, 609, 20),
(20, 17, '2017-01-01 00:00:00', 60, 610, 12),
(21, 18, '2017-02-02 00:00:00', 61, 701, 3),
(22, 15, '2017-03-06 00:00:00', 62, 702, 5),
(23, 16, '2017-04-07 00:00:00', 63, 703, 2),
(24, 15, '2017-05-09 00:00:00', 64, 704, 9),
(25, 16, '2017-06-10 00:00:00', 65, 705, 10),
(26, 17, '2017-07-12 00:00:00', 66, 706, 16),
(23, 18, '2017-08-13 00:00:00', 67, 707, 15),
(28, 14, '2017-09-14 00:00:00', 68, 708, 13),
(29, 15, '2017-10-16 00:00:00', 69, 709, 15),
(40, 16, '2017-11-17 00:00:00', 70, 710, 5),
(46, 15, '2017-12-19 00:00:00', 71, 801, 500),
(78, 16, '2017-06-10 00:00:00', 72, 802, 300),
(33, 17, '2017-07-12 00:00:00', 73, 803, 30),
(66, 18, '2017-08-13 00:00:00', 74, 804, 50),
(1, 15, '2017-09-14 00:00:00', 75, 805, 22),
(1, 16, '2017-10-16 00:00:00', 76, 806, 10),
(1, 15, '2017-11-17 00:00:00', 77, 807, 16),
(2, 16, '2017-12-19 00:00:00', 78, 808, 15),
(5, 17, '2017-10-16 00:00:00', 79, 809, 13),
(6, 18, '2017-11-17 00:00:00', 80, 810, 15),
(7, 14, '2017-12-19 00:00:00', 81, 901, 5),
(8, 15, '2017-01-01 00:00:00', 82, 902, 500),
(9, 16, '2017-02-02 00:00:00', 83, 903, 300),
(10, 15, '2017-03-06 00:00:00', 84, 904, 9),
(11, 16, '2017-11-17 00:00:00', 85, 905, 10),
(12, 17, '2017-12-19 00:00:00', 86, 906, 16),
(13, 18, '2017-06-10 00:00:00', 87, 907, 15),
(14, 15, '2017-07-12 00:00:00', 88, 908, 13),
(15, 16, '2017-08-13 00:00:00', 89, 909, 15),
(16, 15, '2017-09-14 00:00:00', 90, 101, 5),
(17, 16, '2017-10-16 00:00:00', 91, 102, 500),
(18, 17, '2017-11-17 00:00:00', 92, 103, 300),
(19, 18, '2017-12-19 00:00:00', 93, 105, 30),
(20, 14, '2017-10-16 00:00:00', 94, 104, 50),
(1, 15, '2017-11-17 00:00:00', 95, 106, 22),
(2, 16, '2017-12-19 00:00:00', 96, 108, 100),
(3, 15, '2017-01-01 00:00:00', 97, 107, 36),
(4, 16, '2017-02-02 00:00:00', 98, 109, 78),
(5, 17, '2017-03-06 00:00:00', 99, 110, 99),
(6, 18, '2017-11-17 00:00:00', 100, 501, 26),
(7, 15, '2017-12-19 00:00:00', 101, 502, 265),
(8, 16, '2017-06-10 00:00:00', 102, 503, 215),
(9, 15, '2017-07-12 00:00:00', 103, 505, 98),
(10, 16, '2017-08-13 00:00:00', 104, 506, 66),
(11, 17, '2017-09-14 00:00:00', 105, 501, 34),
(12, 18, '2017-01-06 00:00:00', 106, 502, 31),
(12, 18, '2017-01-06 00:00:00', 106, 503, 89),
(12, 18, '2017-01-06 00:00:00', 106, 505, 59),
(15, 1, '2017-05-06 00:00:00', 109, 506, 70),
(15, 1, '2017-05-06 00:00:00', 109, 1110, 9),
(17, 5, '2016-02-03 00:00:00', 111, 1111, 672),
(18, 6, '2018-09-09 00:00:00', 112, 1112, 96),
(19, 7, '2017-06-11 00:00:00', 113, 1113, 771),
(19, 7, '2017-06-11 00:00:00', 113, 1201, 18),
(19, 7, '2017-06-11 00:00:00', 113, 1202, 275),
(2, 10, '2017-12-01 00:00:00', 116, 1203, 76),
(2, 10, '2017-12-01 00:00:00', 116, 1204, 790),
(4, 12, '2017-05-05 00:00:00', 118, 1205, 157),
(5, 15, '2017-08-10 00:00:00', 119, 806, 397),
(5, 15, '2017-08-10 00:00:00', 119, 807, 422),
(5, 15, '2017-08-10 00:00:00', 119, 808, 553),
(5, 15, '2017-08-10 00:00:00', 119, 809, 717),
(9, 17, '2020-01-01 00:00:00', 123, 810, 528),
(10, 18, '2017-01-07 00:00:00', 124, 901, 347),
(11, 15, '2017-02-07 00:00:00', 125, 902, 877),
(12, 16, '2017-01-01 00:00:00', 126, 903, 73),
(13, 15, '2017-02-02 00:00:00', 127, 904, 250),
(14, 16, '2017-03-06 00:00:00', 128, 905, 201),
(15, 17, '2017-04-07 00:00:00', 129, 906, 130),
(16, 18, '2017-05-09 00:00:00', 130, 907, 507),
(17, 1, '2017-06-10 00:00:00', 131, 908, 460),
(18, 1, '2017-07-12 00:00:00', 132, 909, 332),
(19, 1, '2017-08-13 00:00:00', 133, 910, 680),
(20, 4, '2017-09-14 00:00:00', 134, 1001, 831),
(21, 5, '2017-10-16 00:00:00', 135, 1002, 451),
(22, 16, '2017-11-17 00:00:00', 136, 1003, 601),
(23, 17, '2017-12-19 00:00:00', 137, 1004, 276),
(24, 18, '2017-01-01 00:00:00', 138, 102, 695),
(25, 19, '2017-02-02 00:00:00', 139, 103, 195),
(26, 20, '2017-03-06 00:00:00', 140, 105, 41),
(23, 1, '2017-04-07 00:00:00', 141, 104, 305),
(28, 2, '2017-05-09 00:00:00', 142, 106, 836),
(29, 3, '2017-06-10 00:00:00', 143, 108, 348),
(40, 4, '2017-07-12 00:00:00', 144, 107, 378),
(46, 5, '2017-08-13 00:00:00', 145, 109, 187),
(78, 6, '2017-09-14 00:00:00', 146, 110, 703),
(33, 7, '2017-10-16 00:00:00', 147, 501, 841),
(66, 8, '2017-11-17 00:00:00', 148, 502, 7),
(26, 9, '2017-12-19 00:00:00', 149, 503, 728),
(23, 10, '2017-01-01 00:00:00', 150, 505, 309),
(28, 10, '2017-02-02 00:00:00', 151, 506, 98),
(29, 11, '2017-03-06 00:00:00', 152, 507, 250),
(40, 12, '2017-04-07 00:00:00', 153, 509, 848),
(46, 13, '2017-05-09 00:00:00', 154, 510, 308),
(78, 14, '2017-06-10 00:00:00', 155, 504, 849),
(33, 15, '2017-07-12 00:00:00', 156, 508, 397),
(66, 16, '2017-08-13 00:00:00', 157, 508, 611),
(88, 15, '2017-09-14 00:00:00', 158, 210, 202),
(16, 16, '2017-10-16 00:00:00', 159, 606, 91),
(19, 16, '2017-11-17 00:00:00', 160, 101, 54),
(20, 17, '2017-12-19 00:00:00', 161, 102, 345),
(21, 18, '2017-10-16 00:00:00', 162, 103, 241),
(22, 15, '2017-11-17 00:00:00', 163, 105, 418),
(23, 16, '2017-12-19 00:00:00', 164, 104, 448),
(24, 15, '2017-01-01 00:00:00', 165, 106, 794),
(25, 16, '2017-02-02 00:00:00', 166, 108, 82),
(26, 17, '2017-03-06 00:00:00', 167, 107, 381),
(23, 18, '2017-04-07 00:00:00', 168, 109, 260),
(28, 14, '2017-05-09 00:00:00', 169, 110, 498),
(29, 15, '2017-06-10 00:00:00', 170, 501, 646),
(40, 16, '2017-07-12 00:00:00', 171, 502, 153),
(46, 15, '2017-08-13 00:00:00', 172, 503, 83),
(78, 16, '2017-09-14 00:00:00', 173, 505, 6),
(33, 17, '2017-10-16 00:00:00', 174, 506, 29),
(66, 18, '2017-11-17 00:00:00', 175, 507, 785),
(1, 15, '2017-06-10 00:00:00', 176, 509, 820),
(1, 16, '2017-06-10 00:00:00', 177, 510, 396),
(1, 15, '2017-06-10 00:00:00', 176, 504, 760),
(2, 16, '2017-08-13 00:00:00', 179, 508, 147),
(5, 17, '2017-09-14 00:00:00', 180, 608, 343),
(6, 18, '2017-10-16 00:00:00', 181, 609, 604),
(7, 14, '2017-11-17 00:00:00', 182, 610, 107),
(8, 15, '2017-12-19 00:00:00', 183, 701, 772),
(9, 16, '2017-10-16 00:00:00', 184, 702, 393),
(10, 15, '2017-11-17 00:00:00', 185, 703, 247),
(66, 8, '2017-12-19 00:00:00', 186, 704, 670),
(26, 9, '2017-01-01 00:00:00', 187, 705, 503),
(23, 10, '2017-02-02 00:00:00', 188, 706, 437),
(28, 10, '2017-03-06 00:00:00', 189, 707, 279),
(29, 11, '2017-11-17 00:00:00', 190, 708, 199),
(40, 12, '2017-12-19 00:00:00', 191, 709, 256),
(46, 13, '2017-06-10 00:00:00', 192, 710, 155),
(78, 14, '2017-07-12 00:00:00', 193, 801, 560),
(33, 15, '2017-08-13 00:00:00', 194, 802, 877),
(66, 16, '2017-09-14 00:00:00', 195, 803, 44),
(88, 15, '2017-10-16 00:00:00', 196, 804, 202),
(16, 16, '2017-11-17 00:00:00', 197, 805, 642),
(19, 16, '2017-12-19 00:00:00', 198, 806, 520),
(20, 17, '2017-10-16 00:00:00', 199, 807, 853),
(21, 18, '2017-11-17 00:00:00', 200, 808, 413),
(8, 10, '2017-12-19 00:00:00', 201, 809, 761),
(8, 10, '2017-12-19 00:00:00', 201, 810, 71),
(8, 10, '2017-12-19 00:00:00', 201, 901, 59),
(11, 11, '2017-03-06 00:00:00', 204, 902, 798),
(12, 12, '2017-11-17 00:00:00', 205, 903, 86),
(13, 13, '2017-12-19 00:00:00', 206, 904, 640),
(14, 14, '2017-06-10 00:00:00', 207, 905, 196),
(14, 14, '2017-06-10 00:00:00', 207, 906, 73),
(14, 14, '2017-06-10 00:00:00', 207, 907, 664),
(18, 18, '2017-06-10 00:00:00', 211, 908, 761),
(18, 18, '2017-06-10 00:00:00', 211, 909, 413),
(19, 19, '2017-12-01 00:00:00', 212, 101, 333),
(19, 20, '2017-12-01 00:00:00', 213, 102, 516),
(1, 1, '2017-12-01 00:00:00', 214, 103, 485),
(2, 2, '2017-12-01 00:00:00', 215, 105, 858),
(3, 3, '2017-12-01 00:00:00', 216, 104, 204);


 -- summarize  number of customers and transactions for each month in 2017, keeping transactions that were greater or equal to $5.


 SELECT 
    MONTH(transaction_date) AS month,
    DATENAME(MONTH, transaction_date) AS month_name,
    COUNT(DISTINCT customer_id) AS number_of_customers,
    COUNT(DISTINCT transaction_id) AS number_of_transactions,
    SUM(sales) AS total_sales

FROM  wfm_transactions  
WHERE transaction_date BETWEEN '2017-01-01' AND '2017-12-31'  AND sales >= 5
GROUP BY  MONTH(transaction_date),
    DATENAME(MONTH, transaction_date)
ORDER BY  month;
