--Paid Users In April 2020


--Interview Question Date: February 2021

--Ring Central
--Easy
--ID 2017

create database paid_users;
use paid_users;

create table  rc_calls(
call_id bigint,
date datetime,
user_id bigint
);

create table rc_users(
company_id	bigint,
status varchar(40),
user_id  bigint
);


-- Insert data into rc_calls table
INSERT INTO rc_calls (call_id, date, user_id) VALUES
(0, '2020-04-19 01:06:00', 1218),
(1, '2020-03-01 16:51:00', 1554),
(2, '2020-03-29 07:06:00', 1857),
(3, '2020-03-07 02:01:00', 1525),
(4, '2020-04-28 21:39:00', 1271),
(5, '2020-03-18 04:49:00', 1181),
(6, '2020-04-12 23:57:00', 1950),
(7, '2020-04-11 02:15:00', 1339),
(8, '2020-03-21 08:56:00', 1910),
(9, '2020-03-07 15:47:00', 1093),
(10, '2020-04-25 13:55:00', 1859),
(11, '2020-04-17 16:38:00', 1079),
(12, '2020-04-15 12:14:00', 1519),
(13, '2020-04-25 19:59:00', 1854),
(14, '2020-03-16 21:19:00', 1968),
(15, '2020-03-30 23:11:00', 1891),
(16, '2020-03-14 15:21:00', 1575),
(17, '2020-04-06 18:39:00', 1162),
(18, '2020-04-01 18:31:00', 1503),
(19, '2020-04-08 08:44:00', 1884),
(20, '2020-03-10 10:04:00', 1854),
(21, '2020-03-04 14:44:00', 1525),
(22, '2020-03-02 17:07:00', 1181),
(23, '2020-03-29 11:17:00', 1503),
(24, '2020-04-11 14:26:00', 1859),
(25, '2020-03-13 23:52:00', 1859),
(26, '2020-04-10 00:41:00', 1859),
(27, '2020-03-28 00:35:00', 1854),
(28, '2020-04-27 22:09:00', 1891),
(29, '2020-04-19 06:39:00', 1181),
(30, '2020-04-15 22:27:00', 1525),
(31, '2020-03-17 15:21:00', 1093),
(32, '2020-04-03 02:00:00', 1857),
(33, '2020-03-20 14:41:00', 1884),
(34, '2020-03-17 11:17:00', 1950),
(35, '2020-04-15 03:38:00', 1162),
(36, '2020-03-08 06:47:00', 1162),
(37, '2020-04-22 01:46:00', 1891),
(38, '2020-04-08 05:35:00', 1554),
(39, '2020-03-11 08:33:00', 1910);

-- Insert data into rc_users table
INSERT INTO rc_users (user_id, status, company_id) VALUES
(1218, 'free', 1),
(1554, 'inactive', 1),
(1857, 'free', 2),
(1525, 'paid', 1),
(1271, 'inactive', 2),
(1181, 'inactive', 2),
(1950, 'free', 1),
(1339, 'free', 2),
(1910, 'free', 2),
(1093, 'paid', 3),
(1859, 'free', 1),
(1079, 'paid', 2),
(1519, 'inactive', 2),
(1854, 'paid', 1),
(1968, 'inactive', 2),
(1891, 'paid', 2),
(1575, 'free', 2),
(1162, 'paid', 2),
(1503, 'inactive', 3),
(1884, 'free', 1);

--How many paid users had any calls in Apr 2020?

select * from rc_calls  ;
select * from rc_users  ;

select  count(Distinct( u.user_id) )  
from   rc_calls c join
rc_users u  on  c.user_id = u.user_id
where c.date BETWEEN '2020-04-01 00:00:00' AND '2020-04-30 23:59:59'   --- FORMAT(c.date, '%Y-%m') = '2020-04';  
and  u.status = 'paid';